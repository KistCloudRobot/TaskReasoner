PREFIXES:
	PREFIX arbi: <http://www.arbi.com//ontologies#>;
	PREFIX isro: <http://www.arbi.com//BuiltInPlan#>;		

plan perform PostThrowWorkflow(){
	ID : "postthrowworkflow"
	precondition:
		FACT TaskReasoner($reasoner);
	body:
		$reasoner.sleep(1000);
		post perform ThrowWorkflow();
	utility : 120;
}

PLAN Conclude PersonCall($callID,$location,$cmd){
	ID : "personCallConcludePrepareStoring"
	precondition:
		FACT TaskReasoner($reasoner);
		$cmd == "PrepareStoring";
	body:
	
		System.out.println("PrepareStoring personcall start");
		assert PrepareStoring($location);
		post perform PostThrowWorkflow();
	utility : 1000;
}


PLAN Conclude PersonCall($callID,$location,$cmd){
	ID : "personCallConcludeStoring"
	precondition:
		FACT TaskReasoner($reasoner);
		$cmd == "Storing";
	body:
		System.out.println("Storing personcall start");
		assert Storing($location);
		post perform PostThrowWorkflow();
	utility : 1000;
}
PLAN Conclude PersonCall($callID,$location,$cmd){
	ID : "personCallConcludePrepareUnstoring"
	precondition:
		FACT TaskReasoner($reasoner);
		$cmd == "PrepareUnstoring";
	body:
		System.out.println("PrepareUnstoring personcall start");
		
		assert PrepareUnstoring($location);
		post perform PostThrowWorkflow();
	utility : 1000;
}
PLAN Conclude PersonCall($callID,$location,$cmd){
	ID : "personCallConcludeUnstoiring"
	precondition:
		FACT TaskReasoner($reasoner);
		$cmd == "Unstoring";
	body:
		System.out.println("Unstoring personcall start");
		
		assert Unstoring($location);
		post perform PostThrowWorkflow();
	utility : 1000;
}

PLAN Conclude PersonCall($callID,$location,$cmd){
	ID : "personCallConcludeUnstoiringtr"
	precondition:
		FACT TaskReasoner($reasoner);
	body:
		System.out.println("personcall start?");
		System.out.println($callID + " " + $location + " " + $cmd);
	utility : 20;
}


PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow"
	PRECONDITION :
		fact PrepareStoring($location);
		
		FACT TaskReasoner($reasoner);
	BODY :
		System.out.println("\n\n workflow start PREPARE_STORING \n\n");
		
		PERFORM ThrowGoal("CargoStoringPreparedRequestedTo");
		System.out.println("CargoStoringPrepared finalized");
		PERFORM WaitGoalComplete("CargoStoringPreparedRequestedFrom");
		
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","CargoStoringPrepared");


		System.out.println("goal thrown");
				
		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
		System.out.println("PalletTransportedRequested finalized");
	
		PERFORM ThrowGoal("CargoStoringPreparedReportedTo");
		System.out.println("CargoStoringPreparedReportedTo start");
		
		PERFORM WaitGoalComplete("CargoStoringPreparedReportedFrom");
		
<<<<<<< HEAD
		RETRACT PrepareStoring($location);
		
		System.out.println("CargoStoringPreparedReportedTo finalized");
		//PERFORM FinalizeService($serviceName, $cmd);
=======
		PERFORM FinalizeService();
>>>>>>> refs/remotes/origin/main
		
	UTILITY : 50;
}


PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflowPrepareStoringNotExecuted"
	PRECONDITION :
		fact PrepareStoring($location);
		fact PerformedPrepareStoring();
	BODY :
	
		RETRACT PerformedPrepareStoring();
		System.out.println("\n\n workflow start PREPARE_STORING Not Executed\n\n");
		
		//PERFORM FinalizeService($serviceName, $cmd);
		
	UTILITY : 60;
}

PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow2"
	PRECONDITION :
		fact Storing($location);
	BODY :
		System.out.println("\n\n workflow start Storing \n\n");
		
		PERFORM ThrowGoal("StoredCargoRequestedTo");
		
		PERFORM WaitGoalComplete("StoredCargoRequestedFrom");
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","StoredCargo");


		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
		
		System.out.println("?????");
		
		PERFORM ThrowGoal("StoredCargoReportedTo");
		//PERFORM FinalizeService($serviceName, $taskType);
		
		System.out.println("?????2");
		
		PERFORM WaitGoalComplete("StoredCargoReportedFrom");
		PERFORM FinalizeService($serviceName, $taskType);
		
		RETRACT Storing($location);
		System.out.println("StoredCargoRequest finalized");
	UTILITY : 50;
}

PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow2NW"
	PRECONDITION :
		fact Storing($location);
		fact PerformedStoring();
	BODY :
		RETRACT PerformedStoring();
		System.out.println("\n\n workflow start PASS STORING \n\n");
		
	UTILITY : 60;
}

PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow3"
	PRECONDITION :
		FACT PrepareUnstoring($location);
	BODY :
		System.out.println("\n\n workflow start PrepareUnstoring \n\n");
		
		PERFORM ThrowGoal("CargoUnstoringPreparedRequestedTo");
		
		perform WaitGoalComplete("CargoUnstoringPreparedRequestedFrom");
		
		System.out.println("CargoUnstoringPrepared start");
		System.out.println("here?????1");
		
		
		
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","CargoUnstoringPrepared");
		PERFORM ThrowGoalWithType("MovingRackTransportedRequestedTo","CargoUnstoringPrepared");
		
		System.out.println("here?????2");
		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
<<<<<<< HEAD
=======
		System.out.println("here?????3");
>>>>>>> refs/remotes/origin/main
		PERFORM WaitGoalComplete("MovingRackTransportedReportedFrom");
		
		PERFORM ThrowGoal("CargoUnstoringPreparedReportedTo");
		PERFORM WaitGoalComplete("CargoUnstoringPreparedReportedFrom");
		
<<<<<<< HEAD
		//PERFORM FinalizeService($serviceName, $taskType);
		RETRACT PrepareUnstoring($location);
=======
		PERFORM FinalizeService();
		
>>>>>>> refs/remotes/origin/main
		System.out.println("CargoUnstoringPrepared finalized");
	UTILITY : 50;
}

PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow4"
	PRECONDITION :
		FACT Unstoring($location);
	BODY :
		System.out.println("\n\n workflow start Unstoring \n\n");
		
		
		PERFORM ThrowGoal("UnstoredCargoRequestedTo");
		PERFORM WaitGoalComplete("UnstoredCargoRequestedFrom");
		
		
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","UnstoredCargo");

		PERFORM ThrowGoalWithType("MovingRackTransportedRequestedTo","UnstoredCargo");		
		System.out.println("goal thrown");
		
		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
		
		PERFORM WaitGoalComplete("MovingRackTransportedReportedFrom");
		
		System.out.println("goal throw");
		PERFORM ThrowGoal("UnstoredCargoReportedTo");
		PERFORM WaitGoalComplete("UnstoredCargoReportedFrom");
		
<<<<<<< HEAD
		//PERFORM FinalizeService($serviceName, $taskType);
		RETRACT Unstoring($location);
=======
		PERFORM FinalizeService();
		
>>>>>>> refs/remotes/origin/main
		System.out.println("unstored cargo request finalized");
				
	UTILITY : 50;
}
PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow4NW"
	PRECONDITION :
		FACT Unstoring($location);
		fact PerformedUnstoring();
	BODY :
		RETRACT PerformedUnstoring();
		System.out.println("\n\n workflow start PASS Unstoring \n\n");
		
	UTILITY : 60;
}
PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow3NW"
	PRECONDITION :
		FACT PrepareUnstoring($location);
		fact PerformedPrepareUnstoring();
	BODY :
		RETRACT PerformedPrepareUnstoring();
		System.out.println("\n\n workflow start PASS Prepare Unstoring \n\n");
	UTILITY : 60;
}

PLAN PERFORM ThrowWorkflow() {
	ID : "LogisticManagerWorkflow5"
	PRECONDITION :
		FACT Unstoring($location);
		Fact PrepareStoring($pLocation);
		Fact PrepareUnstoring($psLocation);
		FACT TaskReasoner($reasoner);
	BODY :
		System.out.println("\n\n workflow start BOTH UNstoring Storing \n\n");
		
		
		assert PerformedPrepareStoring();
		assert PerformedUnstoring();
		assert PerformedPrepareUnstoring();
		
		PERFORM ThrowGoal("CargoUnstoringPreparedRequestedTo");
		
		perform WaitGoalComplete("CargoUnstoringPreparedRequestedFrom");
		
		PERFORM ThrowGoal("CargoStoringPreparedRequestedTo");

		PERFORM WaitGoalComplete("CargoStoringPreparedRequestedFrom");
		
		PERFORM ThrowGoal("UnstoredCargoRequestedTo");
		PERFORM WaitGoalComplete("UnstoredCargoRequestedFrom");
		
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","UnstoredCargoAndCargoStoringPrepared");
		PERFORM ThrowGoalWithType("MovingRackTransportedRequestedTo","UnstoredCargo");
<<<<<<< HEAD
		
		$reasoner.sleep(3000);
		
=======
		$reasoner.sleep(15000);
>>>>>>> refs/remotes/origin/main
		PERFORM ThrowGoalWithType("MovingRackTransportedRequestedTo","CargoUnstoringPrepared");
		

		System.out.println("goal thrown");
		
		PERFORM WaitGoalComplete("MovingRackTransportedRequestedTo");
		
		PERFORM WaitGoalComplete("MovingRackTransportedRequestedFrom");
		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
		
		PERFORM ThrowGoalWithType("PalletTransportedRequestedTo","CargoUnstoringPrepared");
		PERFORM WaitGoalComplete("PalletTransportedReportedFrom");
		
		PERFORM ThrowGoal("UnstoredCargoReportedTo");
		PERFORM WaitGoalComplete("UnstoredCargoReportedFrom");
		
		//PERFORM FinalizeService($serviceName, $taskType);
		
		RETRACT Unstoring($location);
		RETRACT PrepareStoring($pLocation);
		RETRACT PrepareUnstoring($psLocation);
		System.out.println("unstored cargo request finalized");
				
	UTILITY : 100;
}


PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoStoringPreparedRequestedTo22"
	PRECONDITION :
		$goalName == "CargoStoringPreparedRequestedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoStoringPreparedRequestedTo $worker $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoStoringPreparedReportedTo22"
	PRECONDITION :
		$goalName == "CargoStoringPreparedReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoStoringPreparedReportedTo $worker $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}


PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalStoredCargoRequestedTo22"
	PRECONDITION :
		$goalName == "StoredCargoRequestedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(StoredCargoRequestedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}


PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalStoredCargoReportedTo22"
	PRECONDITION :
		$goalName == "StoredCargoReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(StoredCargoReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}


PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalUnstoredCargoRequestedTo22"
	PRECONDITION :
		$goalName == "UnstoredCargoRequestedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(UnstoredCargoRequestedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalUnstoredCargoReportedTo22"
	PRECONDITION :
		$goalName == "UnstoredCargoReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(UnstoredCargoReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoUnstoringPreparedRequestedTo22"
	PRECONDITION :
		$goalName == "CargoUnstoringPreparedRequestedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoUnstoringPreparedRequestedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoUnstoringPreparedReportedTo22"
	PRECONDITION :
		$goalName == "CargoUnstoringPreparedReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoUnstoringPreparedReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}


PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoStoringPreparedReportedTo"
	PRECONDITION :
		$goalName == "CargoStoringPreparedReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoStoringPreparedReportedTo $worker $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalStoredCargoReportedTo"
	PRECONDITION :
		$goalName == "StoredCargoReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(StoredCargoReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalUnstoredCargoReportedTo"
	PRECONDITION :
		$goalName == "UnstoredCargoReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(UnstoredCargoReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}

PLAN PERFORM ThrowGoal($goalName) {
	ID : "ThrowGoalCargoUnstoringPreparedReportedTo"
	PRECONDITION :
		$goalName == "CargoUnstoringPreparedReportedTo";
		FACT TaskReasoner($reasoner);
	BODY :
		$data = "(CargoUnstoringPreparedReportedTo $manager $goalID $goal)";
		$reasoner.sendToTM("PostGoal", $data);
		PERFORM WaitGoalComplete($goalName);
	UTILITY : 10;
}


PLAN PERFORM FinalizeService(){
	ID : "FinalizeLogisticManagerWorkflow1"
	PRECONDITION :
		FACT PrepareStoring($location);
		FACT GLMessageManager($glMessageManager);
		FACT PersonCall($callID,$location,$cmd);
		FACT GLMessageManager($glMessageManager);
	BODY :
		System.out.println("start finalize PrepareStoring");
		RETRACT CargoStoringPreparedRequestedTo($v1, $v2, $v3);
		System.out.println("start finalize2");
		RETRACT CargoStoringPreparedReportedFrom($v1, $v2, $v3);
		System.out.println("start finalize3");
		$data = "(context (CompletedPersonCall \"" + $callID + "\" \"" + $location + "\" \"" + $cmd + "\"))";
		System.out.println("start finalize4");
		RETRACT PersonCall($callID,$location,$cmd);
		System.out.println("start finalize5");
		RETRACT PrepareStoring($location);
		$glMessageManager.assertToLTM($data);
		System.out.println("start finalize end");
	UTILITY : 10;
}


PLAN PERFORM FinalizeService(){
	ID : "FinalizeLogisticManagerWorkflow2"
	PRECONDITION :
		FACT Storing($location);
		FACT TaskReasoner($reasoner);
		FACT PersonCall($callID,$location,$cmd);
		FACT GLMessageManager($glMessageManager);
	BODY :
		System.out.println("start finalize StoredCargo");
		RETRACT StoredCargoRequestedTo($v1, $v2, $v3);
		RETRACT StoredCargoReportedFrom($v1, $v2, $v3);
		$data = "(context (CompletedPersonCall \"" + $callID + "\" \"" + $location + "\" \"" + $cmd + "\"))";
		RETRACT PersonCall($callID,$location,$cmd);
		RETRACT Storing($location);
		$glMessageManager.assertToLTM($data);
	UTILITY : 10;
}

PLAN PERFORM FinalizeService(){
	ID : "FinalizeLogisticManagerWorkflow3"
	PRECONDITION :
		FACT Unstoring($location);
		FACT TaskReasoner($reasoner);
		FACT PersonCall($callID,$location,$cmd);
		FACT GLMessageManager($glMessageManager);
	BODY :
		System.out.println("start finalize Unstoring");
		RETRACT UnstoredCargoRequestedTo($v1, $v2, $v3);
		RETRACT UnstoredCargoReportedFrom($v1, $v2, $v3);
		$data = "(context (CompletedPersonCall \"" + $callID + "\" \"" + $location + "\" \"" + $cmd + "\"))";
		
		RETRACT Unstoring($location);
		RETRACT PersonCall($callID,$location,$cmd);
		$glMessageManager.assertToLTM($data);
	UTILITY : 10;
}


PLAN PERFORM FinalizeService(){
	ID : "FinalizeLogisticManagerWorkflow4"
	PRECONDITION :
		FACT PrepareUnstoring($location);
		FACT PersonCall($callID, $location, $taskType);
		FACT TaskReasoner($reasoner);
		FACT GLMessageManager($glMessageManager);
	BODY :
		System.out.println("start finalize PrepareUnstoring");
		RETRACT CargoUnstoringPreparedRequestedTo($v1, $v2, $v3);
		RETRACT CargoUnstoringPreparedReportedFrom($v1, $v2, $v3);
		$data = "(context (CompletedPersonCall \"" + $callID + "\" \"" + $location + "\" \"" + $taskType + "\"))";
		RETRACT PersonCall($callID, $location, $taskType);
		RETRACT PrepareUnstoring($location);
		$glMessageManager.assertToLTM($data);
	UTILITY : 10;
}